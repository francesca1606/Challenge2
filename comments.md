COmemnts in the code marked with @note.

You have sometimes made things more complicated than necessary, but I apprecieted the effort you put into this. Good documenting with doxygen.

